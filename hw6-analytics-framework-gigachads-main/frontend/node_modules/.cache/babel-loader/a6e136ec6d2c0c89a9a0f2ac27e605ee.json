{"ast":null,"code":"var _jsxFileName = \"/Users/nathanan/Documents/CMU Senior Spring 2022/17-514 Software Construction/hw5_santorini/santorini/frontend/src/App.tsx\";\nimport { Component } from 'react';\nimport './App.css';\nimport { Square } from './Square';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar oldHref = \"http://localhost:3000\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cells: [{\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }, {\n        text: \"\"\n      }],\n      instructions: \"\",\n      posSelection: -1,\n      workerSelection: -1,\n      turn: 0,\n      playerStates: [],\n      winner: -1,\n      canBuild: true,\n      canMove: true,\n      exception: \"\"\n    };\n    this.clickHandler = this.clickHandler.bind(this);\n    this.resetSelections = this.resetSelections.bind(this);\n  }\n\n  clickHandler(index) {\n    if (this.tileHasWorkerFromPlayer(index, this.state.turn.valueOf()) != -1) {\n      this.setState({\n        workerSelection: index\n      });\n    } else {\n      this.setState({\n        posSelection: index\n      });\n    }\n\n    this.updateInstructions();\n  }\n\n  updateInstructions() {\n    var instructions = \"\";\n\n    if (this.state.winner != -1) {\n      instructions = \"Player \" + this.state.winner + \" Won!\";\n    } else if (this.state.workerSelection == -1) {\n      instructions = \"Select a worker\";\n    } else if (this.state.posSelection == -1) {\n      instructions = \"Select a position\";\n    } else {\n      instructions = \"Select a command\";\n    }\n\n    this.setState({\n      instructions: instructions\n    });\n  }\n\n  updateStateFromGame(json) {\n    const turn = Number(this.getTurn(json));\n    const winner = Number(this.getWinner(json));\n    const canMove = this.getCanMove(json);\n    const canBuild = this.getCanBuild(json);\n    const exception = this.getException(json);\n    this.setState({\n      cells: this.convertToCell(json),\n      turn: turn,\n      playerStates: this.convertPlayerStates(json),\n      winner: winner,\n      canMove: canMove,\n      canBuild: canBuild,\n      exception: exception\n    });\n    this.updateInstructions();\n\n    if (!canMove && canBuild) {\n      this.setState({\n        workerSelection: this.getWorkerSelection()\n      });\n    }\n\n    if (!canMove && !canBuild) {\n      this.endTurn();\n    }\n  }\n\n  getWorkerSelection() {\n    var workerSelection = localStorage.getItem('workerSelection') || \"-1\";\n    return parseInt(workerSelection);\n  }\n\n  convertPlayerStates(p) {\n    const playerStates = [];\n\n    for (var i = 0; i < p[\"playerStates\"].length; i++) {\n      const workerStates = [];\n\n      if (p[\"playerStates\"][i][\"workerStates\"]) {\n        for (var j = 0; j < p[\"playerStates\"][i][\"workerStates\"].length; j++) {\n          var w = {\n            workerId: p[\"playerStates\"][i][\"workerStates\"][j][\"workerId\"],\n            x: p[\"playerStates\"][i][\"workerStates\"][j][\"x\"],\n            y: p[\"playerStates\"][i][\"workerStates\"][j][\"y\"]\n          };\n          workerStates.push(w);\n        }\n      }\n\n      var godCardString = p[\"playerStates\"][i][\"godCard\"] ? p[\"playerStates\"][i][\"godCard\"] : \"\";\n      var c = {\n        playerId: p[\"playerStates\"][i][\"playerId\"],\n        workerStates: workerStates,\n        godCardString: godCardString\n      };\n      playerStates.push(c);\n    }\n\n    return playerStates;\n  }\n\n  convertToCell(p) {\n    const newCells = [];\n\n    for (var i = 0; i < p[\"board\"].length; i++) {\n      var c = {\n        text: p[\"board\"][i][\"text\"]\n      };\n      newCells.push(c);\n    }\n\n    return newCells;\n  }\n\n  getTurn(p) {\n    return p[\"turn\"];\n  }\n\n  getWinner(p) {\n    return p[\"winner\"];\n  }\n\n  getCanMove(p) {\n    return p[\"canMove\"];\n  }\n\n  getCanBuild(p) {\n    return p[\"canBuild\"];\n  }\n\n  getException(p) {\n    if (p[\"exception\"]) {\n      return p[\"exception\"];\n    }\n\n    return \"\";\n  }\n\n  async newGame() {\n    const response = await fetch(\"newgame\");\n    const json = await response.json();\n    this.updateStateFromGame(json);\n  }\n\n  async setWorker(url) {\n    const href = \"setworker?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.updateStateFromGame(json);\n\n    if (json[\"playerStates\"][this.state.turn.valueOf()][\"workerStates\"].length == 2) {\n      this.endTurn();\n    }\n  }\n\n  async move(url) {\n    const href = \"move?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    var index = url.split(\"=\")[url.split(\"=\").length - 1];\n    localStorage.setItem('workerSelection', index);\n    this.updateStateFromGame(json);\n  }\n\n  async addLevel(url) {\n    const href = \"addlevel?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.updateStateFromGame(json);\n  }\n\n  async addDome(url) {\n    const href = \"adddome?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.updateStateFromGame(json);\n  }\n\n  async setGodCard(url) {\n    const href = \"setgodcard?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.endTurn();\n    this.updateStateFromGame(json);\n  }\n\n  async undo() {\n    const response = await fetch(\"undo\");\n    const json = await response.json();\n    this.updateStateFromGame(json);\n  }\n\n  async endTurn() {\n    const response = await fetch(\"endturn\");\n    const json = await response.json();\n    this.updateStateFromGame(json);\n  }\n\n  async switch() {\n    if (window.location.href === \"http://localhost:3000/newgame\" && oldHref !== window.location.href) {\n      console.log(\"newGame\");\n      this.newGame();\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/addlevel\" && oldHref !== window.location.href) {\n      this.addLevel(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/adddome\" && oldHref !== window.location.href) {\n      this.addDome(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/move\" && oldHref !== window.location.href) {\n      this.move(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href === \"http://localhost:3000/undo\" && oldHref !== window.location.href) {\n      this.undo();\n      oldHref = window.location.href;\n    } else if (window.location.href === \"http://localhost:3000/endturn\" && oldHref !== window.location.href) {\n      console.log(\"endTurn\");\n      this.endTurn();\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/setworker\" && oldHref !== window.location.href) {\n      console.log(\"setWorker\");\n      this.setWorker(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/setgodcard\" && oldHref !== window.location.href) {\n      console.log(\"setgodcard\");\n      this.setGodCard(window.location.href);\n      oldHref = window.location.href;\n    }\n  }\n\n  tileHasWorker(index) {\n    var x = Math.floor(index / 5);\n    var y = index % 5;\n\n    for (var player of this.state.playerStates) {\n      for (var workerState of player.workerStates) {\n        if (workerState.x == x && workerState.y == y) {\n          return workerState.workerId;\n        }\n      }\n    }\n\n    return -1;\n  }\n\n  getPlayerFromTile(index) {\n    var x = Math.floor(index / 5);\n    var y = index % 5;\n\n    for (var player of this.state.playerStates) {\n      for (var workerState of player.workerStates) {\n        if (workerState.x == x && workerState.y == y) {\n          return player.playerId;\n        }\n      }\n    }\n\n    return -1;\n  }\n\n  tileHasWorkerFromPlayer(index, playerId) {\n    var x = Math.floor(index / 5);\n    var y = index % 5;\n\n    if (this.state.playerStates != [] && this.state.playerStates[playerId]) {\n      var player = this.state.playerStates[playerId];\n\n      for (var workerState of player.workerStates) {\n        if (workerState.x == x && workerState.y == y) {\n          return workerState.workerId;\n        }\n      }\n    }\n\n    return -1;\n  }\n\n  resetSelections() {\n    this.setState({\n      workerSelection: -1,\n      posSelection: -1\n    });\n  }\n\n  generateGodCardScreen() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Santorini\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"It is Player \", this.state.turn, \"'s turn \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Instruction: Choose a god card.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"bottombar\",\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/setgodcard?card=None\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"None\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/setgodcard?card=Demeter\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Demeter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 48\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/setgodcard?card=Pan\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Pan\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 44\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/setgodcard?card=Minotaur\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Minotaur\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 49\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/newgame\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 32\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }, this);\n  }\n\n  generateSelectWorkerScreen() {\n    const rows = [0, 0, 0, 0, 0].map((_, i) => {\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [...this.state.cells].splice(i * 5, 5).map((_ref, j) => {\n          let {\n            text\n          } = _ref;\n          var index = i * 5 + j;\n          var color = \"darkorange\";\n\n          if (this.state.workerSelection == index) {\n            color = \"blue\";\n          } else if (this.state.posSelection == index) {\n            color = \"green\";\n          }\n\n          var circleBorder = \"0px\";\n          var circleColor = \"white\";\n\n          if (this.tileHasWorker(index) != -1) {\n            circleBorder = \"10px\";\n\n            if (this.getPlayerFromTile(index) == 0) {\n              circleColor = \"black\";\n            }\n          }\n\n          return /*#__PURE__*/_jsxDEV(Square, {\n            onClick: () => {\n              this.clickHandler(i * 5 + j);\n            },\n            contents: text,\n            color: color,\n            circleBorder: circleBorder,\n            circleColor: circleColor\n          }, i * 5 + j, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 11\n          }, this);\n        })\n      }, \"row_\" + i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 7\n      }, this);\n    });\n    let playerStatesP = [];\n\n    if (this.state.playerStates != [] && this.state.playerStates[0] && this.state.playerStates[0].hasOwnProperty(\"workerStates\")) {\n      playerStatesP = this.state.playerStates.map(_ref2 => {\n        let {\n          playerId,\n          workerStates\n        } = _ref2;\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player\", playerId, \":\", workerStates.map(_ref3 => {\n            let {\n              workerId,\n              x,\n              y\n            } = _ref3;\n            return /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"workerId \", workerId, \": (\", x, \",\", y, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 49\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 7\n        }, this);\n      });\n    }\n\n    const decisionState = \"player=\" + this.state.turn + \"&worker=\" + this.tileHasWorker(this.state.workerSelection.valueOf()) + \"&pos=\" + this.state.posSelection;\n    var godCard = \"\";\n\n    if (this.state.playerStates.length > 0) {\n      godCard = String(this.state.playerStates[this.state.turn.valueOf()].godCardString);\n    }\n\n    var exception = undefined;\n\n    if (this.state.exception != \"\") {\n      exception = /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Error! \", this.state.exception]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 17\n      }, this);\n    }\n\n    const workerSelectionScreen = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Santorini\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 443,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"exception\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"It is Player \", this.state.turn, \"'s turn \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player \", this.state.turn, \" has GodCard: \", godCard, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Instruction: Select a worker position\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Position Selection: \", this.state.posSelection]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          cellSpacing: \"0\",\n          id: \"table\",\n          style: {\n            margin: 'auto',\n            width: \"auto\",\n            height: \"auto\",\n            backgroundColor: 'darkorange',\n            color: 'white',\n            fontSize: \"3em\",\n            tableLayout: 'fixed'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: rows\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"bottombar\",\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.resetSelections,\n            children: \"Reset Selection\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 12\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/setworker?\" + decisionState,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"SetWorker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/newgame\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 5\n    }, this);\n\n    return workerSelectionScreen;\n  }\n\n  generateMainGame() {\n    const rows = [0, 0, 0, 0, 0].map((_, i) => {\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [...this.state.cells].splice(i * 5, 5).map((_ref4, j) => {\n          let {\n            text\n          } = _ref4;\n          var index = i * 5 + j;\n          var color = \"darkorange\";\n\n          if (this.state.workerSelection == index) {\n            color = \"blue\";\n          } else if (this.state.posSelection == index) {\n            color = \"green\";\n          }\n\n          var circleBorder = \"0px\";\n          var circleColor = \"white\";\n\n          if (this.tileHasWorker(index) != -1) {\n            circleBorder = \"10px\";\n\n            if (this.getPlayerFromTile(index) == 0) {\n              circleColor = \"black\";\n            }\n          }\n\n          return /*#__PURE__*/_jsxDEV(Square, {\n            onClick: () => {\n              this.clickHandler(i * 5 + j);\n            },\n            contents: text,\n            color: color,\n            circleBorder: circleBorder,\n            circleColor: circleColor\n          }, i * 5 + j, false, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 11\n          }, this);\n        })\n      }, \"row_\" + i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 7\n      }, this);\n    });\n    let playerStatesP = [];\n\n    if (this.state.playerStates != [] && this.state.playerStates[0] && this.state.playerStates[0].hasOwnProperty(\"workerStates\")) {\n      playerStatesP = this.state.playerStates.map(_ref5 => {\n        let {\n          playerId,\n          workerStates\n        } = _ref5;\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player\", playerId, \":\", workerStates.map(_ref6 => {\n            let {\n              workerId,\n              x,\n              y\n            } = _ref6;\n            return /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"workerId \", workerId, \": (\", x, \",\", y, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 49\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 7\n        }, this);\n      });\n    }\n\n    const decisionState = \"player=\" + this.state.turn + \"&worker=\" + this.tileHasWorker(this.state.workerSelection.valueOf()) + \"&pos=\" + this.state.posSelection;\n    var godCard = \"\";\n\n    if (this.state.playerStates.length > 0) {\n      godCard = String(this.state.playerStates[this.state.turn.valueOf()].godCardString);\n    }\n\n    var addLevelButton = undefined;\n    var addDomeButton = undefined;\n    var moveButton = undefined;\n\n    if (this.state.canMove) {\n      moveButton = /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"/move?\" + decisionState,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Move\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 53\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 18\n      }, this);\n    } else {\n      addDomeButton = /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"/adddome?\" + decisionState,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Build Dome\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 60\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 537,\n        columnNumber: 21\n      }, this);\n      addLevelButton = /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"/addlevel?\" + decisionState,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Build Level\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 62\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 22\n      }, this);\n    }\n\n    var exception = undefined;\n\n    if (this.state.exception != \"\") {\n      exception = /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Error! \", this.state.exception]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 543,\n        columnNumber: 17\n      }, this);\n    }\n\n    const mainGame = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Santorini\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 9\n        }, this), exception, /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"It is Player \", this.state.turn, \"'s turn \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 551,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player \", this.state.turn, \" has GodCard: \", godCard, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Instruction: \", this.state.instructions]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 553,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Worker Selection: \", this.state.workerSelection]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Position Selection: \", this.state.posSelection]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player can Move? \", Boolean(this.state.canMove).toString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player can Build? \", Boolean(this.state.canBuild).toString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          cellSpacing: \"0\",\n          id: \"table\",\n          style: {\n            margin: 'auto',\n            width: \"auto\",\n            height: \"auto\",\n            backgroundColor: 'darkorange',\n            color: 'white',\n            fontSize: \"3em\",\n            tableLayout: 'fixed'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: rows\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"bottombar\",\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.resetSelections,\n            children: \"Reset Selections\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 574,\n            columnNumber: 12\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 9\n        }, this), addLevelButton, addDomeButton, moveButton, /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/endturn\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"End Turn Early\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/newgame\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 579,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 573,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 5\n    }, this);\n\n    const wonGame = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Santorini\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 586,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"It is Player \", this.state.turn, \"'s turn \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 587,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Player \", this.state.turn, \" has GodCard: \", godCard, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Instruction: \", this.state.instructions]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          cellSpacing: \"0\",\n          id: \"table\",\n          style: {\n            margin: 'auto',\n            width: \"auto\",\n            height: \"auto\",\n            backgroundColor: 'darkorange',\n            color: 'white',\n            fontSize: \"3em\",\n            tableLayout: 'fixed'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: rows\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 603,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 585,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"bottombar\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/newgame\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 606,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 605,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 584,\n      columnNumber: 5\n    }, this);\n\n    if (this.state.winner != -1) {\n      return wonGame;\n    }\n\n    return mainGame;\n  }\n\n  render() {\n    this.switch();\n    var godCardScreenBool = this.state.playerStates.length > 0 && (this.state.playerStates[0].godCardString == \"\" || this.state.playerStates[1].godCardString == \"\");\n    var selectWorkerState = this.state.playerStates.length > 0 && (this.state.playerStates[0].workerStates == undefined || this.state.playerStates[0].workerStates.length < 2 || this.state.playerStates[1].workerStates == undefined || this.state.playerStates[1].workerStates.length < 2);\n\n    if (godCardScreenBool) {\n      return this.generateGodCardScreen();\n    } else if (selectWorkerState) {\n      return this.generateSelectWorkerScreen();\n    } else if (godCardScreenBool || selectWorkerState) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \" Loading... \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 631,\n        columnNumber: 14\n      }, this);\n    }\n\n    return this.generateMainGame();\n  }\n\n}\n\n;\nexport default App;","map":{"version":3,"sources":["/Users/nathanan/Documents/CMU Senior Spring 2022/17-514 Software Construction/hw5_santorini/santorini/frontend/src/App.tsx"],"names":["Component","Square","oldHref","App","constructor","props","state","cells","text","instructions","posSelection","workerSelection","turn","playerStates","winner","canBuild","canMove","exception","clickHandler","bind","resetSelections","index","tileHasWorkerFromPlayer","valueOf","setState","updateInstructions","updateStateFromGame","json","Number","getTurn","getWinner","getCanMove","getCanBuild","getException","convertToCell","convertPlayerStates","getWorkerSelection","endTurn","localStorage","getItem","parseInt","p","i","length","workerStates","j","w","workerId","x","y","push","godCardString","c","playerId","newCells","newGame","response","fetch","setWorker","url","href","split","move","setItem","addLevel","addDome","setGodCard","undo","switch","window","location","console","log","tileHasWorker","Math","floor","player","workerState","getPlayerFromTile","generateGodCardScreen","textAlign","generateSelectWorkerScreen","rows","map","_","splice","color","circleBorder","circleColor","playerStatesP","hasOwnProperty","decisionState","godCard","String","undefined","workerSelectionScreen","margin","width","height","backgroundColor","fontSize","tableLayout","generateMainGame","addLevelButton","addDomeButton","moveButton","mainGame","Boolean","toString","wonGame","render","godCardScreenBool","selectWorkerState"],"mappings":"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","sourcesContent":["import { Component } from 'react'\nimport './App.css'\nimport { Square } from './Square'\n\nvar oldHref = \"http://localhost:3000\"\n\ninterface Cell {\n  text: String;\n}\n\ninterface WorkerState {\n  workerId: Number;\n  x: Number;\n  y: Number;\n}\n\ninterface PlayerState {\n  playerId: Number;\n  workerStates: Array<WorkerState>;\n  godCardString: String;\n}\n\ninterface Cells {\n  cells: Array<Cell>,\n  instructions: String,\n  playerStates: Array<PlayerState>\n  workerSelection: Number\n  posSelection: Number\n  turn: Number\n  winner: Number\n  canMove: boolean\n  canBuild: boolean\n  exception: String\n}\n\ninterface Props {\n}\n\nclass App extends Component<Props, Cells> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      cells: [ \n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"},\n        { text: \"\"}, \n      ],\n      instructions: \"\",\n      posSelection: -1,\n      workerSelection: -1,\n      turn: 0,\n      playerStates: [],\n      winner: -1,\n      canBuild: true,\n      canMove: true,\n      exception: \"\",\n    };\n    this.clickHandler = this.clickHandler.bind(this);\n    this.resetSelections = this.resetSelections.bind(this);\n  }\n\n\n  clickHandler(index: number){\n    if(this.tileHasWorkerFromPlayer(index, this.state.turn.valueOf()) != -1) {\n      this.setState({workerSelection: index});\n    } else {\n      this.setState({posSelection: index});\n    }\n    this.updateInstructions()\n\n  }\n\n  updateInstructions() {\n    var instructions = \"\"\n    if (this.state.winner != -1) {\n      instructions = \"Player \" + this.state.winner + \" Won!\"\n    }\n    else if (this.state.workerSelection == -1) {\n      instructions = \"Select a worker\"\n    } else if (this.state.posSelection == -1) {\n      instructions = \"Select a position\"\n    } else {\n      instructions = \"Select a command\"\n    }\n    this.setState({instructions: instructions})\n  }\n\n  updateStateFromGame(json: Object) {\n    const turn = Number(this.getTurn(json))\n    const winner = Number(this.getWinner(json))\n    const canMove = this.getCanMove(json)\n    const canBuild = this.getCanBuild(json)\n    const exception = this.getException(json)\n\n    this.setState({ cells: this.convertToCell(json), turn: turn,\n                    playerStates: this.convertPlayerStates(json), winner: winner,\n                    canMove: canMove, canBuild: canBuild, exception: exception})\n\n    this.updateInstructions()\n\n    if (!canMove && canBuild) {\n      this.setState({workerSelection: this.getWorkerSelection()})\n    }\n\n    if (!canMove && !canBuild) {\n      this.endTurn()\n    }\n  }\n\n  getWorkerSelection() {\n    var workerSelection = localStorage.getItem( 'workerSelection' ) || \"-1\";\n    return parseInt(workerSelection)\n  }\n\n  convertPlayerStates(p: any) : Array<PlayerState> {\n    const playerStates: Array<PlayerState> = [];\n    for (var i = 0; i < p[\"playerStates\"].length; i++) {\n      const workerStates: Array<WorkerState> = [];\n      if (p[\"playerStates\"][i][\"workerStates\"]) {\n        for (var j = 0; j < p[\"playerStates\"][i][\"workerStates\"].length; j++) {\n          var w: WorkerState = {\n            workerId: p[\"playerStates\"][i][\"workerStates\"][j][\"workerId\"],\n            x: p[\"playerStates\"][i][\"workerStates\"][j][\"x\"],\n            y: p[\"playerStates\"][i][\"workerStates\"][j][\"y\"]\n          }\n          workerStates.push(w);\n        }\n      }\n\n      var godCardString = p[\"playerStates\"][i][\"godCard\"] ? p[\"playerStates\"][i][\"godCard\"] : \"\"\n      var c: PlayerState = {\n        playerId: p[\"playerStates\"][i][\"playerId\"],\n        workerStates: workerStates,\n        godCardString: godCardString,\n      };\n      playerStates.push(c);\n    }\n    return playerStates;\n  }\n  convertToCell(p: any): Array<Cell> {\n    const newCells: Array<Cell> = [];\n    \n    for (var i = 0; i < p[\"board\"].length; i++) {\n      var c: Cell = {\n        text: p[\"board\"][i][\"text\"],\n      };\n      newCells.push(c);\n    }\n\n    return newCells;\n  }\n\n  getTurn(p: any): String {\n    return p[\"turn\"]\n  }\n\n  getWinner(p: any): String | undefined {\n    return p[\"winner\"]\n  }\n\n  getCanMove(p: any): boolean {\n    return p[\"canMove\"]\n  }\n\n  getCanBuild(p: any): boolean {\n    return p[\"canBuild\"]\n  }\n\n  getException(p: any): String {\n    if (p[\"exception\"]) {\n      return p[\"exception\"]\n    }\n    return \"\"\n  }\n\n  async newGame() {\n    const response = await fetch(\"newgame\");\n    const json = await response.json();\n    this.updateStateFromGame(json);\n  }\n\n  async setWorker(url: String) {\n    const href = \"setworker?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.updateStateFromGame(json)\n    if (json[\"playerStates\"][this.state.turn.valueOf()][\"workerStates\"].length == 2) {\n      this.endTurn()\n    }\n  }\n\n  async move(url: String) {\n    const href = \"move?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    var index = url.split(\"=\")[url.split(\"=\").length - 1]\n    localStorage.setItem( 'workerSelection', index );\n\n    this.updateStateFromGame(json)\n  }\n\n  async addLevel(url: String) {\n    const href = \"addlevel?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.updateStateFromGame(json)\n  }\n\n  async addDome(url: String) {\n    const href = \"adddome?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.updateStateFromGame(json)\n  }\n\n  async setGodCard(url: String) {\n    const href = \"setgodcard?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    this.endTurn();\n    this.updateStateFromGame(json)\n  }\n\n  async undo() {\n    const response = await fetch(\"undo\");\n    const json = await response.json();\n    this.updateStateFromGame(json)\n  }\n\n  async endTurn() {\n    const response = await fetch(\"endturn\");\n    const json = await response.json();\n    this.updateStateFromGame(json)\n  }\n\n  async switch() {\n    if (\n      window.location.href === \"http://localhost:3000/newgame\" &&\n      oldHref !== window.location.href\n    ) {\n      console.log(\"newGame\")\n      this.newGame();\n      oldHref = window.location.href;\n    } else if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/addlevel\" &&\n      oldHref !== window.location.href\n    ) {\n      this.addLevel(window.location.href);\n      oldHref = window.location.href;\n    } else if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/adddome\" &&\n      oldHref !== window.location.href\n    ) {\n      this.addDome(window.location.href);\n      oldHref = window.location.href;\n    } else if (\n        window.location.href.split(\"?\")[0] === \"http://localhost:3000/move\" &&\n        oldHref !== window.location.href\n      ) {\n        this.move(window.location.href);\n        oldHref = window.location.href;\n    } else if (\n      window.location.href === \"http://localhost:3000/undo\" &&\n      oldHref !== window.location.href\n    ) {\n      this.undo();\n      oldHref = window.location.href;\n    } else if (\n      window.location.href === \"http://localhost:3000/endturn\" &&\n      oldHref !== window.location.href\n    ) {\n      console.log(\"endTurn\")\n      this.endTurn();\n      oldHref = window.location.href;\n    } else if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/setworker\" &&\n      oldHref !== window.location.href\n    ) {\n      console.log(\"setWorker\")\n      this.setWorker(window.location.href);\n      oldHref = window.location.href;\n    } else if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/setgodcard\" &&\n      oldHref !== window.location.href\n    ) {\n      console.log(\"setgodcard\")\n      this.setGodCard(window.location.href);\n      oldHref = window.location.href;\n    }\n  };\n\n  tileHasWorker(index : number) : Number {\n    var x : number = Math.floor(index/5)\n    var y : number = index%5\n    for (var player of this.state.playerStates) {\n      for (var workerState of player.workerStates) {\n        if (workerState.x == x && workerState.y == y) {\n          return (workerState.workerId);\n        }\n      }\n    }\n    return -1;\n  }\n\n  getPlayerFromTile(index : number) : Number {\n    var x : number = Math.floor(index/5)\n    var y : number = index%5\n    for (var player of this.state.playerStates) {\n      for (var workerState of player.workerStates) {\n        if (workerState.x == x && workerState.y == y) {\n          return (player.playerId);\n        }\n      }\n    }\n    return -1;\n  }\n\n  tileHasWorkerFromPlayer(index : number, playerId : number) : Number {\n    var x : number = Math.floor(index/5)\n    var y : number = index%5\n    \n    if (this.state.playerStates != [] && this.state.playerStates[playerId]) {\n      var player = this.state.playerStates[playerId]\n      for (var workerState of player.workerStates) {\n        if (workerState.x == x && workerState.y == y) {\n          return (workerState.workerId);\n        }\n      }\n    }\n    return -1;\n  }\n\n  resetSelections() {\n    this.setState({workerSelection: -1, posSelection: -1});\n  }\n\n  generateGodCardScreen() {\n    return (\n      <div className=\"App\">\n        <div style={{textAlign:\"center\"}}>\n          <h1>Santorini</h1>\n          <p>It is Player {this.state.turn}'s turn </p>\n          <p>Instruction: Choose a god card.</p>\n          <br />\n        </div>\n        <div id=\"bottombar\">\n          <a href={\"/setgodcard?card=None\"}><button>None</button></a>\n          <a href={\"/setgodcard?card=Demeter\"}><button>Demeter</button></a>\n          <a href={\"/setgodcard?card=Pan\"}><button>Pan</button></a>\n          <a href={\"/setgodcard?card=Minotaur\"}><button>Minotaur</button></a>\n          <a href={\"/newgame\"}><button>New Game</button></a>\n        </div>\n      </div>\n    )\n  }\n\n  generateSelectWorkerScreen() {\n    const rows = [0,0,0,0,0].map((_,i) => { return ( \n      <tr key={\"row_\" + i}>\n        { [...this.state.cells].splice(i*5,5).map(({ text },j) => { \n\n          var index = i*5+j;\n          var color = \"darkorange\"\n          if (this.state.workerSelection == index) {\n            color = \"blue\"\n          } else if (this.state.posSelection == index) {\n            color = \"green\"\n          }\n          \n          var circleBorder = \"0px\"\n          var circleColor = \"white\"\n          if (this.tileHasWorker(index) != -1) {\n            circleBorder = \"10px\"\n            if (this.getPlayerFromTile(index) == 0) {\n              circleColor = \"black\"\n            }\n          }            \n          return (\n          <Square\n            key={i*5+j}\n            onClick={()=>{this.clickHandler(i*5+j)}}\n            contents={text}\n            color={color}\n            circleBorder={circleBorder}\n            circleColor={circleColor}\n          />\n        )}\n        )}\n      </tr>)\n    }\n  );\n\n  let playerStatesP : JSX.Element[] = []\n  \n  if (this.state.playerStates != [] && this.state.playerStates[0] && \n      this.state.playerStates[0].hasOwnProperty(\"workerStates\")) {\n    playerStatesP = this.state.playerStates.map(({playerId, workerStates}) => { return ( \n      <p>Player{playerId}: \n        { workerStates.map(({workerId, x,y}) => <p>workerId {workerId}: ({x},{y})</p>) }\n      </p>\n    ) }\n  );\n  }\n  const decisionState = \"player=\" + this.state.turn + \"&worker=\" + \n    this.tileHasWorker(this.state.workerSelection.valueOf()) + \"&pos=\" + this.state.posSelection;\n\n  var godCard = \"\"\n  \n  if (this.state.playerStates.length > 0) {\n    godCard = String(this.state.playerStates[this.state.turn.valueOf()].godCardString)\n  }\n\n  var exception = undefined\n  if (this.state.exception != \"\") {\n    exception = <p>Error! {this.state.exception}</p>\n  }\n\n  const workerSelectionScreen = \n    <div className=\"App\">\n      <div style={{textAlign:\"center\"}}>\n        <h1>Santorini</h1>\n        <exception></exception>\n        <p>It is Player {this.state.turn}'s turn </p>\n        <p>Player {this.state.turn} has GodCard: {godCard} </p>\n        <p>Instruction: Select a worker position</p>\n        <p>Position Selection: {this.state.posSelection}</p>\n        <table cellSpacing=\"0\" id=\"table\" style={{\n          margin:'auto',\n          width: \"auto\",\n          height:\"auto\",\n          backgroundColor:'darkorange',\n          color:'white',\n          fontSize:\"3em\",\n          tableLayout:'fixed'\n        }}>\n          <tbody>\n            {rows}\n          </tbody>\n        </table>\n        <br />\n      </div>\n      <div id=\"bottombar\">\n        <a><button onClick={this.resetSelections}>Reset Selection</button></a>\n        <a href={\"/setworker?\" + decisionState} ><button>SetWorker</button></a>\n        <a href={\"/newgame\"}><button>New Game</button></a>\n      </div>\n    </div>\n    return workerSelectionScreen\n  }\n\n  generateMainGame() {\n    const rows = [0,0,0,0,0].map((_,i) => { return ( \n      <tr key={\"row_\" + i}>\n        { [...this.state.cells].splice(i*5,5).map(({ text },j) => { \n\n          var index = i*5+j;\n          var color = \"darkorange\"\n          if (this.state.workerSelection == index) {\n            color = \"blue\"\n          } else if (this.state.posSelection == index) {\n            color = \"green\"\n          }\n          \n          var circleBorder = \"0px\"\n          var circleColor = \"white\"\n          if (this.tileHasWorker(index) != -1) {\n            circleBorder = \"10px\"\n            if (this.getPlayerFromTile(index) == 0) {\n              circleColor = \"black\"\n            }\n          }            \n          return (\n          <Square\n            key={i*5+j}\n            onClick={()=>{this.clickHandler(i*5+j)}}\n            contents={text}\n            color={color}\n            circleBorder={circleBorder}\n            circleColor={circleColor}\n          />\n        )}\n        )}\n      </tr>)\n    }\n  );\n\n  let playerStatesP : JSX.Element[] = []\n  \n  if (this.state.playerStates != [] && this.state.playerStates[0] && \n      this.state.playerStates[0].hasOwnProperty(\"workerStates\")) {\n    playerStatesP = this.state.playerStates.map(({playerId, workerStates}) => { return ( \n      <p>Player{playerId}: \n        { workerStates.map(({workerId, x,y}) => <p>workerId {workerId}: ({x},{y})</p>) }\n      </p>\n    ) }\n  );\n  }\n  const decisionState = \"player=\" + this.state.turn + \"&worker=\" + \n    this.tileHasWorker(this.state.workerSelection.valueOf()) + \"&pos=\" + this.state.posSelection;\n\n  var godCard = \"\"\n  \n  if (this.state.playerStates.length > 0) {\n    godCard = String(this.state.playerStates[this.state.turn.valueOf()].godCardString)\n  }\n\n  var addLevelButton = undefined\n  var addDomeButton = undefined\n  var moveButton = undefined\n\n  if (this.state.canMove) {\n    moveButton = <a href={\"/move?\" + decisionState}><button>Move</button></a>\n  }\n  else {\n    addDomeButton = <a href={\"/adddome?\" + decisionState} ><button>Build Dome</button></a>\n    addLevelButton = <a href={\"/addlevel?\" + decisionState} ><button>Build Level</button></a>\n  }\n\n  var exception = undefined\n  if (this.state.exception != \"\") {\n    exception = <p>Error! {this.state.exception}</p>\n  }\n\n  const mainGame = \n    <div className=\"App\">\n      <div style={{textAlign:\"center\"}}>\n        <h1>Santorini</h1>\n        {exception}\n        <p>It is Player {this.state.turn}'s turn </p>\n        <p>Player {this.state.turn} has GodCard: {godCard} </p>\n        <p>Instruction: {this.state.instructions}</p>\n        <p>Worker Selection: {this.state.workerSelection}</p>\n        <p>Position Selection: {this.state.posSelection}</p>\n        <p>Player can Move? {Boolean(this.state.canMove).toString()}</p>\n        <p>Player can Build? {Boolean(this.state.canBuild).toString()}</p>\n        <table cellSpacing=\"0\" id=\"table\" style={{\n          margin:'auto',\n          width: \"auto\",\n          height:\"auto\",\n          backgroundColor:'darkorange',\n          color:'white',\n          fontSize:\"3em\",\n          tableLayout:'fixed'\n        }}>\n          <tbody>\n            {rows}\n          </tbody>\n        </table>\n        <br />\n      </div>\n      <div id=\"bottombar\">\n        <a><button onClick={this.resetSelections}>Reset Selections</button></a>\n        {addLevelButton}\n        {addDomeButton}\n        {moveButton}\n        <a href={\"/endturn\"}><button>End Turn Early</button></a>\n        <a href={\"/newgame\"}><button>New Game</button></a>\n      </div>\n    </div>\n\n    const wonGame = \n    <div className=\"App\">\n      <div style={{textAlign:\"center\"}}>\n        <h1>Santorini</h1>\n        <p>It is Player {this.state.turn}'s turn </p>\n        <p>Player {this.state.turn} has GodCard: {godCard} </p>\n        <p>Instruction: {this.state.instructions}</p>\n        <table cellSpacing=\"0\" id=\"table\" style={{\n          margin:'auto',\n          width: \"auto\",\n          height:\"auto\",\n          backgroundColor:'darkorange',\n          color:'white',\n          fontSize:\"3em\",\n          tableLayout:'fixed'\n        }}>\n          <tbody>\n            {rows}\n          </tbody>\n        </table>\n        <br />\n      </div>\n      <div id=\"bottombar\">\n        <a href={\"/newgame\"}><button>New Game</button></a>\n      </div>\n    </div>\n\n    if (this.state.winner != -1) {\n      return wonGame\n    }\n    return mainGame\n  }\n\n  render() {\n    this.switch()\n\n    var godCardScreenBool = this.state.playerStates.length > 0 && \n    (this.state.playerStates[0].godCardString == \"\" || this.state.playerStates[1].godCardString == \"\")\n\n    var selectWorkerState = this.state.playerStates.length > 0 && \n    ((this.state.playerStates[0].workerStates == undefined || this.state.playerStates[0].workerStates.length < 2) ||\n    (this.state.playerStates[1].workerStates == undefined || this.state.playerStates[1].workerStates.length < 2))\n\n    if (godCardScreenBool) {\n      return this.generateGodCardScreen();\n    } else if (selectWorkerState) {\n      return this.generateSelectWorkerScreen();\n    } else if (godCardScreenBool || selectWorkerState) {\n      return <div> Loading... </div>\n    }\n    return this.generateMainGame()\n  };\n};\n\nexport default App;"]},"metadata":{},"sourceType":"module"}