{"ast":null,"code":"var _jsxFileName = \"/Users/nathanan/Documents/CMU Senior Spring 2022/17-514 Software Construction/hw5_santorini/santorini/frontend/src/App.tsx\";\nimport { Component } from 'react';\nimport './App.css';\nimport { Square } from './Square';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar oldHref = \"http://localhost:3000\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cells: [{\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=0&y=0\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=1&y=0\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=2&y=0\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=3&y=0\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=4&y=0\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=0&y=1\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=1&y=1\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=2&y=1\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=3&y=1\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=4&y=1\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=0&y=2\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=1&y=2\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=2&y=2\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=3&y=2\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=4&y=2\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=0&y=3\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=1&y=3\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=2&y=3\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=3&y=3\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=4&y=3\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=0&y=4\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=1&y=4\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=2&y=4\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=3&y=4\"\n      }, {\n        text: \"\",\n        clazz: \"playable\",\n        link: \"/play?x=4&y=4\"\n      }],\n      instructions: \"It is Player 2's turn\",\n      posSelection: -1,\n      workerSelection: -1,\n      turn: 0\n    };\n    this.clickHandler = this.clickHandler.bind(this);\n  }\n\n  clickHandler(index) {\n    console.log(index);\n\n    if (this.state.workerSelection == -1) {\n      this.setState({\n        workerSelection: index\n      });\n    } else {\n      this.setState({\n        posSelection: index\n      });\n    }\n  }\n\n  convertToCell(p) {\n    const newCells = [];\n\n    for (var i = 0; i < p[\"board\"].length; i++) {\n      var c = {\n        text: p[\"board\"][i][\"text\"],\n        //clazz: p[\"board\"][i][\"clazz\"],\n        clazz: `clazz`,\n        link: p[\"board\"][i][\"link\"]\n      };\n      newCells.push(c);\n    }\n\n    return newCells;\n  }\n\n  getTurn(p) {\n    return p[\"turn\"];\n  }\n\n  getWinner(p) {\n    return p[\"winner\"];\n  }\n\n  getInstr(turn, winner) {\n    if (winner === undefined) return \"It is Player \" + turn + \"'s turn\";else return \"Player \" + winner + \" wins!\";\n  }\n\n  async newGame() {\n    const response = await fetch(\"newgame\");\n    const json = await response.json();\n    const turn = Number(this.getTurn(json));\n    const newCells = this.convertToCell(json);\n    this.setState({\n      cells: this.convertToCell(json),\n      instructions: \"It is Player 0's turn\",\n      turn: turn\n    });\n  }\n\n  async play(url) {\n    const href = \"play?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    const newCells = this.convertToCell(json);\n    const turn = this.getTurn(json);\n    console.log(turn);\n    const winner = this.getWinner(json);\n    const instr = this.getInstr(turn, winner);\n    this.setState({\n      cells: newCells,\n      instructions: instr\n    });\n  }\n\n  async undo() {\n    const response = await fetch(\"undo\");\n    const json = await response.json();\n    const newCells = this.convertToCell(json);\n    const turn = this.getTurn(json);\n    const winner = this.getWinner(json);\n    const instr = this.getInstr(turn, winner);\n    this.setState({\n      cells: newCells,\n      instructions: instr\n    });\n  }\n\n  async switch() {\n    if (window.location.href === \"http://localhost:3000/newgame\" && oldHref !== window.location.href) {\n      this.newGame();\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/play\" && oldHref !== window.location.href) {\n      this.play(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href === \"http://localhost:3000/undo\" && oldHref !== window.location.href) {\n      this.undo();\n      oldHref = window.location.href;\n    }\n  }\n\n  render() {\n    this.switch();\n    const style = {\n      margin: 'auto',\n      width: \"auto\",\n      height: \"auto\",\n      backgroundColor: 'darkorange',\n      color: 'white',\n      fontSize: \"3em\",\n      tableLayout: 'fixed'\n    };\n    const rows = [0, 0, 0, 0, 0].map((_, i) => {\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [...this.state.cells].splice(i * 5, 5).map((_ref, j) => {\n          let {\n            text,\n            clazz,\n            link\n          } = _ref;\n          return /*#__PURE__*/_jsxDEV(Square, {\n            onClick: () => {\n              this.clickHandler(i * 5 + j);\n            }\n          }, i * 5 + j, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this);\n        })\n      }, \"row_\" + i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this);\n    });\n    const decisionState = \"player=\" + this.state.turn + \"&worker=\" + this.state.workerSelection + \"&pos=\" + this.state.posSelection;\n    const buildHref = \"/build?\" + decisionState;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Santorini\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.instructions\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.workerSelection\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.posSelection\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          cellSpacing: \"0\",\n          id: \"table\",\n          style: {\n            margin: 'auto',\n            width: \"auto\",\n            height: \"auto\",\n            backgroundColor: 'darkorange',\n            color: 'white',\n            fontSize: \"3em\",\n            tableLayout: 'fixed'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: rows\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"bottombar\",\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/setWorker?\" + decisionState,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"SetWorker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 54\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/build?\" + decisionState,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Build\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/move?\" + decisionState,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"Move\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 48\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/endturn?\" + decisionState,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"End Turn\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 51\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/newgame?\" + decisionState,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: \"New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 51\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\n;\nexport default App;","map":{"version":3,"sources":["/Users/nathanan/Documents/CMU Senior Spring 2022/17-514 Software Construction/hw5_santorini/santorini/frontend/src/App.tsx"],"names":["Component","Square","oldHref","App","constructor","props","state","cells","text","clazz","link","instructions","posSelection","workerSelection","turn","clickHandler","bind","index","console","log","setState","convertToCell","p","newCells","i","length","c","push","getTurn","getWinner","getInstr","winner","undefined","newGame","response","fetch","json","Number","play","url","href","split","instr","undo","switch","window","location","render","style","margin","width","height","backgroundColor","color","fontSize","tableLayout","rows","map","_","splice","j","decisionState","buildHref","textAlign"],"mappings":"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","sourcesContent":["import Handlebars from \"handlebars\"\nimport { Component } from 'react'\nimport './App.css'\nimport { Square } from './Square'\n\nvar oldHref = \"http://localhost:3000\"\n\ninterface Cell {\n  text: String;\n  clazz: String;\n  link: String;\n}\n\ninterface Cells {\n  cells: Array<Cell>,\n  instructions: String,\n  posSelection: Number\n  turn: Number\n  workerSelection: Number\n}\n\ninterface Props {\n}\n\nclass App extends Component<Props, Cells> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      cells: [ \n        { text: \"\", clazz: \"playable\", link: \"/play?x=0&y=0\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=1&y=0\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=2&y=0\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=3&y=0\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=4&y=0\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=0&y=1\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=1&y=1\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=2&y=1\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=3&y=1\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=4&y=1\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=0&y=2\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=1&y=2\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=2&y=2\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=3&y=2\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=4&y=2\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=0&y=3\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=1&y=3\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=2&y=3\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=3&y=3\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=4&y=3\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=0&y=4\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=1&y=4\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=2&y=4\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=3&y=4\" },\n        { text: \"\", clazz: \"playable\", link: \"/play?x=4&y=4\" },\n      ],\n      instructions: \"It is Player 2's turn\",\n      posSelection: -1,\n      workerSelection: -1,\n      turn: 0,\n    };\n    this.clickHandler = this.clickHandler.bind(this);\n  }\n\n  clickHandler(index: Number){\n    console.log(index)\n    if(this.state.workerSelection == -1) {\n      this.setState({workerSelection: index});\n    } else {\n      this.setState({posSelection: index});\n    }\n  }\n\n\n  convertToCell(p: any): Array<Cell> {\n    const newCells: Array<Cell> = [];\n    \n    for (var i = 0; i < p[\"board\"].length; i++) {\n      var c: Cell = {\n        text: p[\"board\"][i][\"text\"],\n        //clazz: p[\"board\"][i][\"clazz\"],\n        clazz: `clazz`,\n        link: p[\"board\"][i][\"link\"],\n      };\n      newCells.push(c);\n    }\n\n    return newCells;\n  }\n\n  getTurn(p: any): String {\n    return p[\"turn\"]\n  }\n\n  getWinner(p: any): String | undefined {\n    return p[\"winner\"]\n  }\n\n  getInstr(turn: String, winner: String | undefined) {\n    if (winner === undefined) return \"It is Player \" + turn + \"'s turn\"\n    else return \"Player \" + winner + \" wins!\"\n  }\n\n  async newGame() {\n    const response = await fetch(\"newgame\");\n    const json = await response.json();\n    const turn = Number(this.getTurn(json))\n\n    const newCells: Array<Cell> = this.convertToCell(json);\n    this.setState({ cells: this.convertToCell(json), instructions: \"It is Player 0's turn\", turn: turn})\n  }\n\n  async play(url: String) {\n    const href = \"play?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n\n    const newCells: Array<Cell> = this.convertToCell(json);\n    const turn = this.getTurn(json)\n    console.log(turn);\n    const winner = this.getWinner(json)\n    const instr = this.getInstr(turn, winner)\n    this.setState({ cells: newCells, instructions: instr })\n  }\n\n  async undo() {\n    const response = await fetch(\"undo\");\n    const json = await response.json();\n\n    const newCells: Array<Cell> = this.convertToCell(json);\n    const turn = this.getTurn(json)\n    const winner = this.getWinner(json)\n    const instr = this.getInstr(turn, winner)\n    this.setState({ cells: newCells, instructions: instr })\n  }\n\n  async switch() {\n    if (\n      window.location.href === \"http://localhost:3000/newgame\" &&\n      oldHref !== window.location.href\n    ) {\n      this.newGame();\n      oldHref = window.location.href;\n    } else if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/play\" &&\n      oldHref !== window.location.href\n    ) {\n      this.play(window.location.href);\n      oldHref = window.location.href;\n    } else if (\n      window.location.href === \"http://localhost:3000/undo\" &&\n      oldHref !== window.location.href\n    ) {\n      this.undo();\n      oldHref = window.location.href;\n    }\n  };\n\n  render() {\n    this.switch()\n\n    const style = {\n      margin:'auto',\n      width: \"auto\",\n      height:\"auto\",\n      backgroundColor:'darkorange',\n      color:'white',\n      fontSize:\"3em\",\n      tableLayout:'fixed',\n    }\n    \n    const rows = [0,0,0,0,0].map((_,i) => { return ( \n        <tr key={\"row_\" + i}>\n          { [...this.state.cells].splice(i*5,5).map(({ text, clazz, link },j) => { return (\n            <Square\n              key={i*5+j}\n              onClick={()=>{this.clickHandler(i*5+j)}}\n           />\n          )}\n          )}\n        </tr>)\n      }\n    );\n    \n    const decisionState = \"player=\" + this.state.turn + \"&worker=\" + this.state.workerSelection + \"&pos=\" + this.state.posSelection;\n    const buildHref = \"/build?\" + decisionState;\n\n    return (\n      <div className=\"App\">\n          <div style={{textAlign:\"center\"}}>\n            <h1>Santorini</h1>\n            <p>{this.state.instructions}</p>\n            <p>{this.state.workerSelection}</p>\n            <p>{this.state.posSelection}</p>\n            <table cellSpacing=\"0\" id=\"table\" style={{\n              margin:'auto',\n              width: \"auto\",\n              height:\"auto\",\n              backgroundColor:'darkorange',\n              color:'white',\n              fontSize:\"3em\",\n              tableLayout:'fixed'\n            }}>\n              <tbody>\n                {rows}\n              </tbody>\n            </table>\n            <br />\n          </div>\n          <div id=\"bottombar\">\n            <a href={\"/setWorker?\" + decisionState} ><button>SetWorker</button></a>\n            <a href={\"/build?\" + decisionState} ><button>Build</button></a>\n            <a href={\"/move?\" + decisionState}><button>Move</button></a>\n            <a href={\"/endturn?\" + decisionState}><button>End Turn</button></a>\n            <a href={\"/newgame?\" + decisionState}><button>New Game</button></a>\n          </div>\n      </div>\n    );\n  };\n};\n\nexport default App;"]},"metadata":{},"sourceType":"module"}